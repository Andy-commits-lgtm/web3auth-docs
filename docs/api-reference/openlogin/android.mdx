---
title: OpenLogin-Android-SDK
sidebar_label: Android (Kotlin, Java)
---

## Requirements

Android API version 21 or newer is required.

## Installation

### Add OpenLogin to Gradle

In your project-level `build.gradle` file, add JitPack repository:

```groovy
allprojects {
    repositories {
        // ...
        maven { url "https://jitpack.io" }
    }
}
```

Then, in your app-level `build.gradle` dependencies section, add the following:

```groovy
dependencies {
    // ...
    implementation 'org.torusresearch:openlogin-android-sdk:-SNAPSHOT'
}
```

**Note**: This SDK is currently in beta, using `-SNAPSHOT` to make sure you receive latest updates
and be aware that there may be breaking changes.

### Permissions

Open your app's `AndroidManifest.xml` file and add the following permission:

```xml
<uses-permission android:name="android.permission.INTERNET" />
```

## Configuration

### Configure an OpenLogin project

Go to [Developer Dashboard](https://developer.tor.us), create or select an OpenLogin project:

- Add `{YOUR_APP_PACKAGE_NAME}://auth` to **Whitelist URLs**.

- Copy the Project ID for usage later.

### Configure Deep Link

Open your app's `AndroidManifest.xml` file and add the following deep link intent filter to your sign-in activity:

```xml
<intent-filter>
    <action android:name="android.intent.action.VIEW" />

    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.BROWSABLE" />

    <!-- Accept URIs: {YOUR_APP_PACKAGE_NAME}://* -->
    <data android:scheme="{YOUR_APP_PACKAGE_NAME}" />
</intent-filter>
```

## Initialization

In your sign-in activity', create an `OpenLogin` instance with your OpenLogin project's configurations and
configure it like this:

```kotlin
class MainActivity : AppCompatActivity() {
    // ...
    lateinit var openlogin: OpenLogin

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        openlogin = OpenLogin(
            this,
            clientId = getString(R.string.openlogin_client_id),
            network = OpenLogin.Network.MAINNET,
            redirectUrl = Uri.parse("{YOUR_APP_PACKAGE_NAME}://auth"),
        )

        // Handle user signing in when app is not alive
        openlogin.setResultUrl(intent?.data)

        // ...
    }

    override fun onNewIntent(intent: Intent?) {
        super.onNewIntent(intent)

        // Handle user signing in when app is active
        openlogin.setResultUrl(intent?.data)

        // ...
    }

    private fun onClickLogin() {
        openlogin.login()
    }

    //...
}
```

Make sure your sign-in activity `launchMode` is set to `singleTop` in your `AndroidManifest.xml`:

```xml
<activity
    android:launchMode="singleTop"
    android:name=".YourActivity">
    // ...
</activity>
```

## Providers

### `OpenLogin Constructor`

Construct and configure an OpenLogin instance

| Parameter   | Type                                      | Mandatory | Description                                                                         |
| ----------- | ----------------------------------------- | --------- | ----------------------------------------------------------------------------------- |
| context     | android.content.Context                   | Yes       | Android context to launch Web-based authentication, usually is the current activity |
| clientId    | String                                    | Yes       | Your OpenLogin project ID                                                           |
| network     | enum com.openlogin.core.OpenLogin.Network | Yes       | Network to run OpenLogin, either MAINNET or TESTNET                                 |
| redirectUrl | android.net.Uri                           | No        | URL that OpenLogin will redirect API responses, default is `null`                   |
| sdkUrl      | String                                    | No        | default is `"https://sdk.openlogin.com"`                                            |

**Example**

```kotlin
package com.openlogin.app

import android.content.Intent
import android.net.Uri
import android.os.Bundle
import androidx.appcompat.app.AppCompatActivity
import com.openlogin.core.OpenLogin

class MainActivity : AppCompatActivity() {
    private lateinit var openlogin: OpenLogin

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        // Configure OpenLogin
        openlogin = OpenLogin(
            this,
            clientId = getString(R.string.openlogin_project_id),
            network = OpenLogin.Network.MAINNET,
            redirectUrl = Uri.parse("torusapp://org.torusresearch.openloginexample/redirect"),
        )
    }
    ...
}
```

### `setResultUrl`

Handle user signing

| Parameter | Type             | Mandatory | Description       |
| --------- | ---------------- | --------- | ----------------- |
| uri       | android.net.Uri? | No        | default is `null` |

**Example**

```kotlin
class MainActivity : AppCompatActivity() {
    ...
    override fun onCreate(savedInstanceState: Bundle?) {
        ...
        openlogin.setResultUrl(intent.data)
        ...
    }

    override fun onNewIntent(intent: Intent?) {
        super.onNewIntent(intent)
        openlogin.setResultUrl(intent?.data)
    }
    ...
}
```

### `login`

Trigger login flow that shows a modal for user to select one of supported
providers to login e.g. Google, Facebook, Twitter, Passwordless, etc

| Parameter         | Type                                       | Mandatory | Description                                                                                                                                                                                                  |
| ----------------- | ------------------------------------------ | --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| loginProvider     | enum com.openlogin.core.OpenLogin.Provider | Yes       | Login provider, supported values are `GOOGLE, FACEBOOK, REDDIT, DISCORD, TWITCH, APPLE, LINE, GITHUB, KAKAO, LINKEDIN, TWITTER, WEIBO, WECHAT, EMAIL_PASSWORDLESS`                                           |
| fastLogin         | Boolean?                                   | No        | If user was previously logged in to the same device and then setting fastLogin to true provides a way to login with webauthn directly without going through loginProvider authentication, default is `null`  |
| relogin           | Boolean?                                   | No        | default is `null`                                                                                                                                                                                            |
| skipTKey          | Boolean?                                   | No        | default is `null`                                                                                                                                                                                            |
| extraLoginOptions | Map<String, Any>?                          | No        | You can pass various oauth supported options, default is `null`                                                                                                                                              |
| redirectUrl       | android.net.Uri?                           | No        | Url where user will be redirected after successfull login. By default user will be redirected to same page where login will be initiated, default is `null`                                                  |
| appState          | String?                                    | No        | appState can be used to keep track of the app state when user will be redirected to app after login, default is `null`                                                                                       |

**Example**

```kotlin
import android.widget.Button
import com.openlogin.core.OpenLogin
import android.os.Bundle

class MainActivity : AppCompatActivity() {
    private lateinit var openlogin: OpenLogin

    private fun signIn() {
        openlogin.login(OpenLogin.Provider.GOOGLE)
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        ...
        // Setup UI and event handlers
        val signInButton = findViewById<Button>(R.id.signInButton)
        signInButton.setOnClickListener { signIn() }
        ...
    }
    ...
}
```

### `logout`

Trigger logout flow

| Parameter   | Type             | Mandatory | Description       |
| ----------- | ---------------- | --------- | ----------------- |
| fastLogin   | Boolean?         | No        | If fastLogin is passed as true then user can relogin again by just using webauthn url, else user will be completely logged out and has to go through loginProvider authentication. Default value is `null` |
| redirectUrl | android.net.Uri? | No        | Url where user will be redirected after successfull logout. Default value is `null` |
| appState    | String?          | No        | appState can be used to keep track of the app state when user will be redirected to app after logout. Default value is `null` |

**Example**

```kotlin
import android.widget.Button
import com.openlogin.core.OpenLogin
import android.os.Bundle

class MainActivity : AppCompatActivity() {
    private lateinit var openlogin: OpenLogin

    private fun signOut() {
        openlogin.logout()
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        ...
        // Setup UI and event handlers
        val signOutButton = findViewById<Button>(R.id.signOutButton)
        signOutButton.setOnClickListener { signOut() }
        ...
    }
    ...
}
```

### `addAuthStateChangeListener`

Register a handler that listens to authentication state change

| Parameter               | Type                    | Mandatory | Description       |
| ----------------------- | ----------------------- | --------- | ----------------- |
| authStateChangeListener | AuthStateChangeListener | Yes       | default is `null` |

**Example**

```kotlin
import android.os.Bundle
import android.view.View
import android.widget.Button
import android.widget.TextView
import androidx.appcompat.app.AppCompatActivity
import com.google.gson.Gson
import com.openlogin.core.AuthStateChangeListener
import com.openlogin.core.OpenLogin

class MainActivity : AppCompatActivity() {
    private lateinit var openlogin: OpenLogin

    private val gson = Gson()

    private fun reRender() {
        val contentTextView = findViewById<TextView>(R.id.contentTextView)
        val signInButton = findViewById<Button>(R.id.signInButton)
        val signOutButton = findViewById<Button>(R.id.signOutButton)

        val key = openlogin.state.privKey
        val userInfo = openlogin.state.userInfo
        if (key is String && key.isNotEmpty()) {
            contentTextView.text = gson.toJson(openlogin.state)
            contentTextView.visibility = View.VISIBLE
            signInButton.visibility = View.GONE
            signOutButton.visibility = View.VISIBLE
        } else {
            contentTextView.text = getString(R.string.not_logged_in)
            contentTextView.visibility = View.GONE
            signInButton.visibility = View.VISIBLE
            signOutButton.visibility = View.GONE
        }
    }

    override fun onCreate(savedInstanceState: Bundle?) {
        ...
        openlogin.addAuthStateChangeListener(AuthStateChangeListener {
            reRender()
        })
        ...
    }
    ...
}
```

### `removeAuthStateChangeListener`

Degister a handler from listening to authentication state change

| Parameter               | Type                    | Mandatory | Description       |
| ----------------------- | ----------------------- | --------- | ----------------- |
| authStateChangeListener | AuthStateChangeListener | Yes       | default is `null` |
