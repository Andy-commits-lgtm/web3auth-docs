---
title: Account Abstraction
description: "Account Abstraction | Documentation - Web3Auth"
---

Account abstraction is a term commonly used to address the use of smart contract wallets. These
smart contract wallets are based on the ERC-4337 which aims at improving the user onboarding journey
and enabling more sophisticated transaction patterns by abstracting details like validation, gas
payment, and execution from the user.

Before exploring the details of account abstraction, it's i mportant to first understand the
limitations of Externally Owned Accounts (EOAs), like MetaMask and Rainbow, and how account
abstraction addresses these challenges.

## Problem with EOAs

Since the beginning of Web3, wallets have been a crucial component for interacting with the
blockchain. The most common type of wallet is the Externally Owned Account (EOA), which is a wallet
controlled by a private key.

Altough it still fails to onboard new users due to non intuitive user experience of navigating the
blockchain ecosystem and managing the wallets. EOA wallets, regardless of type, can only be accessed
through private keys.

You must have heard the quote, “Not your keys, not your crypto”. The user is solely responsible for
safeguarding the private key with the best practices, which can often be overwhelming for the
general non tech savvy users. Once the private key is compromised or lost, EOA wallet cannot recover
the account and can result in irreversible loss of assets.

Moreover the EOA wallets doesn't support advanced transaction patterns like batch transactions,
sponsored transactions, etc.

## Why Smart Contracts Wallets?

Smart contract wallets solve the problem of onboarding by allowing users to use social logins or
other web2 authentication for account management, and recovery. Moreover, SCWs provide more granular
control and programmability like

### Batch transactions

Smart contract wallets allow users to perform batch transactions, where user can perform multiple
transactions in a single call. In traditional EOA wallets, if you want to swap Token A to Token B,
you need to first approve the Token A, and perform the swap operation. Here you had to sign twice,
and execute two different transactions. In SCWs, you can perform all these transactions in a single
call. Learn how to perform
[batch transactions with Smart Contract Wallets](/docs/sdk/pnp/web/providers/aa-provider#send-batch-transaction).

### Gas Sponsorship

For transactions performed through EOA wallets, the user has to pay the gas fees in native token of
the chain which makes it difficult to onboard new users who are not familiar with the ecosystem.
Smart contract wallets solve this problem by using paymaster to sponsor the gas fees, or let the
users pay the transaction fees in USDC/supported ERC-20 token.

### Programmable

Smart contract wallets are programmable. They can perform certain functions on autopilot - for
instance swap ETH to USDT token, when ETH price is $2700, adding limit to their spendings and
advanced multi-signature accounts. Developers can also create their own smart contract wallets with
custom logic.

## Components of ERC 4337

Smart contract wallets did exist before ERC 4337 but lacked a standardization across the ecosystem
which reduced the interoperability. ERC 4337 helps to standardize account abstraction across all the
Ethereum compatible chains. ERC 4337 consists of a few main components which help us achieve account
abstraction.

### UserOperation

A UserOperation is the transaction object for the smart contract wallets, and was introduced to
avoid the changes on the EVM. Unlike EOA wallets, where the user signs the transaction, in smart
contract wallets, the user signs a UserOperation.

### UserOp Mempool

Mempools for User Operation are separate from the regular blockchain transaction mempool.ERC 4337
introduces an alternative to the mempool, called UserOp Mempool, which helps to keep track of
pending UserOperations. It acts as a waiting room and helps bundlers to keep track of
UserOperations.

### Bundler

Unlike the RPC nodes responsible for validating the transactions and submitting them to the
blockchain, bundlers are third party nodes that bundles the UserOperations, perform the validation,
and runs the simulations before submitting them on-chain.

The bundler is also responsible to validate that the Paymaster has enough balance to sponsor the gas
fees for the batch transactions. For aggregated UserOperations, the bundler also ensures that the
aggregated signature is created, and the UserOperations are updated with the same. The aggregated
signatures are used to improve the efficiency and scalability of transaction processing by bundler.

### EntryPoint

The EntryPoint contract, as its name suggests, serves as the global singleton that manages
UserOperations by validating and executing them. When a UserOperation is submitted, the EntryPoint
performs the following key tasks:

![EntryPoint](/images/entrypoint.png)

- If the UserOperations are bundled into a single transaction, the EntryPoint validates the
  aggregated signature to ensure its validity.

- The EntryPoint checks if the user's account is already deployed. If it isn't, the contract deploys
  the account using the CREATE2Factory. Afterwards, the EntryPoint uses the Account contract to
  validate the UserOperation.

- If a Paymaster is involved in the UserOperation, the EntryPoint verifies that the Paymaster has
  agreed to cover the transaction fees by validating its signature. If no Paymaster is used, the
  EntryPoint ensures that the user has sufficient balance to pay for the gas fees.

- After successfully validating the UserOperation and Paymaster details, the EntryPoint proceeds to
  execute the transaction.

### Smart Account

Smart accounts are user facing accounts deployed through the CREATE2Factory. Each smart account
contains a key function called `validateUserOp`, which validates the UserOperation. This function is
triggered by the EntryPoint contract during the operation validation phase.

Beyond basic functionality, smart accounts can incorporate advanced features like account recovery,
autopilot execution, spend limits, and other customizable, programmable capabilities.

### Paymaster

The paymaster component of the ERC 4337 is responsible for sponsoring the gas fees for the
UserOperations. The paymaster contract also allows the user to pay the gas fees with the supported
ERC-20 tokens.

The paymaster contract must implement the `validatePaymasterUserOp` function which is called by the
EntryPoint contract during the validation phase. The paymaster also has additional `postOp` function
which is called by the EntryPoint contract after the transaction is executed. This function handles
the additional logic required by the paymaster. For instance, withdraw the ERC-20 token from the
user's account after the transaction is executed.

### Aggregator

As the name suggests, the aggregator contract is responsible for aggregating the signatures of the
UserOperations. The aggregator contract must implement the `aggregateSignatures` function which
takes in a list of signatures and returns the aggregated signature. The signatues are usually
aggregated by the bundler to improve improve the efficiency and scalability of transaction
processing, as it allows bundler to submit multiple UserOperations in a single transaction.

For validating the aggregated signature, the Aggregator also has the `validateSignatures` function
used by the EntryPoint contract during the validation phase.

## Native Account Abstraction

Web3Auth offers seamless integration of Account Abstraction with just a few lines of code, making it
easier than ever to onboard users into decentralized applications. Our goal is to simplify and
streamline the entire process while ensuring users benefit from advanced functionality. Web3Auth
native account abstraction, we allow you to create and manage smart accounts using your favorite
libraries like Viem, Ethers, and Web3.js. With this, you don't need to rely on third party packages
to effortlessly create ERC-4337 compatible Smart Contract Wallets (SCWs), and give users the ability
to perform batch transactions and efficiently manage gas sponsorship.

Web3Auth's native account abstraction gives you the flexibility to choose your preferred account
abstraction provider, configure your bundler client, and integrate your paymaster. Learn how to use
[Web3Auth with Account Abstraction](/docs/sdk/pnp/web/providers/aa-provider).
